
stream create --name ingest-avhrr --definition "scan-for-avhrr-granules: file --dir=/usr/local/data/nexus/avhrr/ --mode=ref --pattern=*.nc --maxMessages=1 | header-absolutefilepath: header-enricher --headers={\"absolutefilepath\":\"payload\"} | dataset-tiler --dimensions=lat,lon --tilesDesired=1296 | join-with-static-time: transform --expression=\"'time:0:1,'+payload.stream().collect(T(java.util.stream.Collectors).joining(';time:0:1,'))+';file://'+headers['absolutefilepath']\" | python-chain: tcpshell --command='python -u -m nexusxd.processorchain' --environment=CHAIN=nexusxd.tilereadingprocessor.read_grid_data:nexusxd.emptytilefilter.filter_empty_tiles:nexusxd.tilesumarizingprocessor.summarize_nexustile,VARIABLE=analysed_sst,LATITUDE=lat,LONGITUDE=lon,TIME=time,READER=GRIDTILE,TEMP_DIR=/tmp,STORED_VAR_NAME=analysed_sst --bufferSize=1000000 --remoteReplyTimeout=360000 | add-id: script --script=file:///usr/local/spring-xd/current/xd-nexus-shared/generate-tile-id.groovy | set-dataset-name: script --script=file:///usr/local/spring-xd/current/xd-nexus-shared/set-dataset-name.groovy --variables='datasetname=AVHRR_OI_L4_GHRSST_NCEI' | nexus --cassandraContactPoints=192.168.173.36 --cassandraKeyspace=nexustiles --solrUrl=http://192.168.173.36:8983/solr/ --solrCollection=nexustiles --cassandraPort=9042"


stream create --name ingest-modis-chla --definition "scan-for-chla-granules: file --dir=/usr/local/data/nexus/modis_chl_a/ --mode=ref --pattern=*.nc --maxMessages=1 | header-absolutefilepath: header-enricher --headers={\"absolutefilepath\":\"payload\"} | dataset-tiler --dimensions=lat,lon --tilesDesired=1296 | join: transform --expression=\"payload.stream().collect(T(java.util.stream.Collectors).joining(';'))+';file://'+headers['absolutefilepath']\" | python-chain: tcpshell --command='python -u -m nexusxd.processorchain' --environment=CHAIN=nexusxd.tilereadingprocessor.read_grid_data:nexusxd.emptytilefilter.filter_empty_tiles:nexusxd.tilesumarizingprocessor.summarize_nexustile,VARIABLE=chlor_a,LATITUDE=lat,LONGITUDE=lon,READER=GRIDTILE,TEMP_DIR=/tmp,STORED_VAR_NAME=chlor_a --bufferSize=1000000 --remoteReplyTimeout=360000 | add-id: script --script=file:///usr/local/spring-xd/current/xd-nexus-shared/generate-tile-id.groovy | add-time: script --script=file:///usr/local/spring-xd/current/xd-nexus-shared/add-time-from-granulename.groovy --variables='regex=^A(\\d{7}),dateformat=yyyyDDD' | set-dataset-name: script --script=file:///usr/local/spring-xd/current/xd-nexus-shared/set-dataset-name.groovy --variables='datasetname=MODIS_L3m_DAY_CHL_chlor_a_4km' | nexus --cassandraContactPoints=192.168.173.36 --cassandraKeyspace=nexustiles --solrUrl=http://10.200.10.1:8983/solr/ --solrCollection=nexustiles --cassandraPort=9042"